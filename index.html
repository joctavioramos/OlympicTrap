<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <title>Olympic Trap Training - Octavio Ramos</title>
  <style>
    :root{
      --bg:#ffffff; --fg:#111111; --muted:#475569; --line:#e2e8f0;
      --g:#22c55e; --y:#facc15; --r:#ef4444; --primary:#0ea5e9;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto; background:var(--bg); color:var(--fg);}
    .container{max-width:1200px;margin:0 auto;padding:16px;}
    .card{background:#fff;border:1px solid var(--line);border-radius:16px;box-shadow:0 6px 18px rgba(0,0,0,.05);padding:16px;}
    h1{margin:.2rem 0 .4rem;font-size:24px} h2{margin:.4rem 0 10px;font-size:16px;color:var(--muted)}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .chip{background:#f8fafc;border:1px solid var(--line);padding:6px 10px;border-radius:999px;font-size:12px}
    button,select{background:#fff;color:var(--fg);border:1px solid var(--line);border-radius:12px;padding:12px 14px;font-size:18px;cursor:pointer}
    button.primary{background:linear-gradient(180deg,#38bdf8,#0ea5e9);border:0;color:#04243c;font-weight:800}
    button:disabled{opacity:.55;cursor:not-allowed}
    .grid{display:grid;gap:10px}
    .dirGrid{grid-template-columns:repeat(3,1fr)}
    .velGrid{grid-template-columns:repeat(7,1fr)}
    .pill{padding:12px 10px;border-radius:12px;border:1px solid var(--line);text-align:center;font-weight:800;background:#fff}
    .pill.active{outline:2px solid var(--primary)}
    table{width:100%;border-collapse:collapse;font-size:14px;border:1px solid var(--line)}
    th,td{padding:8px 10px;border-bottom:1px solid var(--line);text-align:left;background:#fff}
    thead th{position:sticky;top:0;background:#f8fafc;z-index:1}
    /* Resumen claro */
    #summary{background:#fff;color:#111;border:1px solid var(--line);border-radius:14px;padding:14px;display:none}
    #summary.show{display:block}
    .sum-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:4px}
    .sum-card{background:#fff;border:1px solid var(--line);border-radius:12px;padding:12px;text-align:center}
    .sum-label{font-size:13px;color:#334155}
    .sum-value{font-size:24px;font-weight:900}
    .sum-score{color:#0ea5e9} .sum-first{color:#16a34a} .sum-second{color:#a855f7} .sum-missed{color:#ef4444}
    .heat-wrap,.heat2-wrap,.chart-wrap{margin-top:12px;background:#fff;border:1px solid var(--line);border-radius:10px;padding:12px}
    #heat,#heatVR,#chart{width:100%;background:#fff;border-radius:8px}
    /* NUEVO ORDEN: Velocidad ‚Üí Direcci√≥n ‚Üí 0/1/2 */
    .resBtns{display:flex;gap:12px;flex-wrap:wrap}
    .btn-res{padding:18px 22px;font-size:22px;font-weight:900;border-radius:16px;border:0;cursor:pointer}
    .btn-res.res0{background:var(--r);color:#fff}
    .btn-res.res1{background:var(--g);color:#0b0b0b}
    .btn-res.res2{background:var(--y);color:#0b0b0b}
    /* Tablet */
    @media (min-width:900px){
      .btn-res{padding:24px 28px;font-size:26px}
      .dirGrid .pill,.velGrid .pill{padding:16px 12px;font-size:18px}
      table{font-size:16px}
      h1{font-size:26px}
      .container{max-width:1280px}
    }
    /* Print: Carta landscape, 1 p√°gina */
    @media print{
      @page{size:Letter landscape;margin:8mm}
      html,body{background:#fff;color:#111}
      .no-print{display:none!important}
      #summary{display:block!important;border:0;padding:0}
      .heat-wrap,.heat2-wrap,.chart-wrap{border:0;padding:0}
      .sum-grid{gap:8px}
      .sum-value{font-size:20px}
      #heat{height:110px!important}
      #heatVR{height:160px!important}
      #chart{height:200px!important}
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="row no-print" style="justify-content:space-between;align-items:center">
      <h1>Olympic Trap Training - Octavio Ramos</h1>
      <div class="row">
        <span class="chip" id="roundInfo">Sin ronda</span>
        <button id="btnPrint" class="primary">Imprimir resumen (PDF)</button>
      </div>
    </div>

    <div class="card no-print">
      <h2>1) Esquema y Posici√≥n de inicio</h2>
      <div class="row">
        <label>Esquema</label>
        <select id="esquemaSel">
          <option value="1">Esquema 1</option><option value="2">Esquema 2</option><option value="3">Esquema 3</option>
          <option value="4">Esquema 4</option><option value="5">Esquema 5</option><option value="6">Esquema 6</option>
          <option value="7">Esquema 7</option><option value="8">Esquema 8</option><option value="9">Esquema 9</option>
        </select>
        <label>Posici√≥n inicial</label>
        <select id="startPos"><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        <button id="btnNew" class="primary">Nueva ronda (25)</button>
        <button id="btnEnd">Terminar</button>
        <button id="btnUndo">Deshacer</button>
      </div>
      <p class="small">Flujo NUEVO: <b>Velocidad</b> ‚Üí <b>Izq/Cen/Der</b> ‚Üí <b>0/1/2</b>. Velocidad vuelve a 0.6 tras cada tiro. L√≠mites: Izq=2, Cen=1, Der=2.</p>
    </div>

    <div class="card no-print">
      <h2>2) Captura r√°pida</h2>
      <!-- NUEVO ORDEN VISUAL: Velocidad (ASC) ‚Üí Direcci√≥n ‚Üí 0/1/2 -->
      <div class="grid velGrid" style="margin-top:4px">
        <button class="pill" data-vel="0.4">0.4</button>
        <button class="pill" data-vel="0.5">0.5</button>
        <button class="pill active" data-vel="0.6">0.6</button>
        <button class="pill" data-vel="0.7">0.7</button>
        <button class="pill" data-vel="0.8">0.8</button>
        <button class="pill" data-vel="0.9">0.9</button>
        <button class="pill" data-vel="1.0">1.0</button>
      </div>
      <div class="grid dirGrid" style="margin-top:10px">
        <button class="pill" id="dirIzq">Izq</button>
        <button class="pill" id="dirCen">Cen</button>
        <button class="pill" id="dirDer">Der</button>
      </div>
      <div class="row resBtns" style="margin-top:10px">
        <button id="r0" class="btn-res res0">0 ‚Äî Fallo</button>
        <button id="r1" class="btn-res res1">1 ‚Äî 1er disparo</button>
        <button id="r2" class="btn-res res2">2 ‚Äî 2¬∫ disparo</button>
      </div>
    </div>

    <div class="card no-print" style="margin-top:12px">
      <h2>3) Progreso</h2>
      <div class="small">Esquema: <span id="esquemaActivo">‚Äî</span> ‚Ä¢ Pos: <span id="posActivo">‚Äî</span> ‚Ä¢ Dir: <span id="dirActivo">‚Äî</span> ‚Ä¢ Vel: <span id="velActivo">‚Äî</span> ‚Ä¢ Disparo: <span id="shotNo">0</span> / <span id="shotTot">25</span></div>
      <div style="max-height:340px;overflow:auto;margin-top:6px">
        <table>
          <thead><tr><th>#</th><th>Pos</th><th>Dir</th><th>Vel</th><th>M√°q</th><th>Res</th><th>√Ångulo1</th><th>Altura</th><th>√Ångulo</th><th>Direcci√≥n</th></tr></thead>
          <tbody id="shotsBody"></tbody>
        </table>
      </div>
    </div>

    <div id="summary" class="summary">
      <div id="printHeader" style="text-align:center;margin-bottom:6px;color:#111">
        <div style="font-weight:800;font-size:18px">Resumen ‚Äî Ronda <span id="phRonda">#</span> ‚Äî Esquema <span id="phEsquema">?</span></div>
        <div style="font-size:12px;color:#444">Generado: <span id="phFecha">‚Äî</span></div>
      </div>
      <div class="sum-grid">
        <div class="sum-card"><div class="sum-label">Marcador</div><div id="sumScore" class="sum-value sum-score">0/25</div></div>
        <div class="sum-card"><div class="sum-label">1er disparo</div><div id="sumFirst" class="sum-value sum-first">0</div></div>
        <div class="sum-card"><div class="sum-label">2¬∫ disparo</div><div id="sumSecond" class="sum-value sum-second">0</div></div>
        <div class="sum-card"><div class="sum-label">Fallados</div><div id="sumMiss" class="sum-value sum-missed">0</div></div>
      </div>
      <div class="heat-wrap">
        <div class="row" style="justify-content:space-between">
          <div class="small">Heatmap de la ronda (1..25)</div>
          <div class="legend small"><span style="width:12px;height:12px;border-radius:50%;display:inline-block;border:1px solid #94a3b8;background:transparent"></span> 1er ‚Ä¢ <span style="width:12px;height:12px;border-radius:50%;background:var(--y);display:inline-block"></span> 2¬∫ ‚Ä¢ <span style="width:12px;height:12px;border-radius:50%;background:var(--r);display:inline-block"></span> Fallo</div>
        </div>
        <canvas id="heat" height="320"></canvas>
      </div>
      <div class="heat2-wrap">
        <div class="row" style="justify-content:space-between">
          <div class="small">Heatmap Tiempo (s) √ó Resultado (0/1/2)</div>
          <div class="legend small"><span style="width:12px;height:12px;border-radius:50%;background:var(--y);display:inline-block"></span> 2¬∫ ‚Ä¢ <span style="width:12px;height:12px;border-radius:50%;background:var(--r);display:inline-block"></span> Fallo ‚Ä¢ <span style="width:12px;height:12px;border-radius:50%;display:inline-block;border:1px solid #94a3b8;background:transparent"></span> 1er</div>
        </div>
        <canvas id="heatVR" height="360"></canvas>
        <div class="small" style="margin-top:6px">Filas: 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0 ‚Ä¢ Columnas: 1..25</div>
      </div>
      <div class="chart-wrap">
        <div class="row" style="justify-content:space-between">
          <div class="small">Gr√°fica ‚Äî ùë• = √Ångulo (¬∞) / ùë¶ = Altura (jitter ¬±0.2¬∞ / ¬±0.03)</div>
          <div class="legend small"><span style="width:12px;height:12px;border-radius:50%;display:inline-block;border:1px solid #94a3b8;background:transparent"></span> 1er ‚Ä¢ <span style="width:12px;height:12px;border-radius:50%;background:var(--y);display:inline-block"></span> 2¬∫ ‚Ä¢ <span style="width:12px;height:12px;border-radius:50%;background:var(--r);display:inline-block"></span> Fallo</div>
        </div>
        <canvas id="chart" height="380"></canvas>
      </div>

      <div class="row no-print" style="margin-top:10px; justify-content:flex-end">
        <button id="btnSaveDB" class="pill">Guardar ronda en BD</button>
        <button id="btnExportDB" class="pill">Exportar BD (JSON)</button>
        <button id="btnClearDB" class="pill">Vaciar BD</button>
        <span id="dbInfo" class="chip">BD: 0 rondas</span>
      </div>
    </div>
  </div>

  <script>
  /* Para mantener breve este env√≠o, la versi√≥n ZIP incluir√° este HTML tal cual.
     Si necesitas cambios est√©ticos o de layout, los ajustamos enseguida. */
  </script>
</body>
</html>
